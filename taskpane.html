<!DOCTYPE html>
<html>

<head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        /* Simple styling for the popup */
        #suggestionPopup {
            display: none;
            position: absolute;
            border: 1px solid #ccc;
            background-color: white;
            padding: 10px;
            z-index: 1000;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body>
    <p>Double-click a word to get suggestions.</p>
    <p>Version 1.0.1</p>
    <div id="suggestionPopup"></div>
    
    <img src="https://pnptelemetry.azurewebsites.net/pnp-officeaddins/samples/word-add-in-hello-world-run" />
    
    <script>
        Office.onReady((info) => {
            // Check that we loaded into Word
            if (info.host === Office.HostType.Word) {
                document.addEventListener('dblclick', onDoubleClick);
            }
        });
        
        async function onDoubleClick(event) {
            event.preventDefault(); // Disable default double-click action

            const selection = await Word.run(async (context) => {
                const range = context.document.getSelection();
                range.load("text");
                await context.sync();
                return range.text;
            });

            if (selection) {
                const suggestions = await fetchSuggestions(selection);
                showSuggestionPopup(event.clientX + window.scrollX, event.clientY + window.scrollY, suggestions);
            }
        }

        async function fetchSuggestions(selectedWord) {
            // Replace this with your actual suggestion logic
            const response = await fetch(`https://jsonplaceholder.typicode.com/posts/1`);
            const data = await response.json();
            return data.body; // Modify this for context-based suggestions.
        }

        function showSuggestionPopup(x, y, suggestion) {
            const popup = document.getElementById("suggestionPopup");
            popup.innerText = suggestion;
            popup.style.left = `${x}px`;
            popup.style.top = `${y}px`;
            popup.style.display = 'block';
        }

        document.addEventListener('click', () => {
            const popup = document.getElementById("suggestionPopup");
            popup.style.display = 'none'; // Hide popup on click elsewhere
        });
    </script>
</body>

</html>
