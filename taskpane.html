<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Office JS Example</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
    </style>
</head>
<body>
    <input type="text" id="outputText" placeholder="Selected text will appear here" readonly style="width: 100%;">
    
    <script>
        Office.onReady(function(info) {
            if (info.host === Office.HostType.Word) {
                // Register the SelectionChanged event handler
                Office.context.document.addHandlerAsync(Office.EventType.SelectionChanged, onSelectionChanged);
            }
        });

        async function onSelectionChanged() {
            await Word.run(async (context) => {
                const selection = context.document.getSelection();
                selection.load('text');

                await context.sync();

                // Display the selected text in the input field
                document.getElementById("outputText").value = selection.text || 'No text selected';
            }).catch(function(error) {
                console.error(error);
            });
        }
    </script>
</body>
</html>
