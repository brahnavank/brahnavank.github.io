<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Get Selected Text Coordinates</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
    <button id="getCoords">Get Selected Text Coordinates</button>
    <div id="output"></div>

    <script>
        Office.onReady(() => {
            if (Office.context.host === Office.HostType.Word) {
                document.getElementById("getCoords").onclick = getSelectedTextCoordinates;
            }
        });

        async function getSelectedTextCoordinates() {
            await Word.run(async (context) => {
                const selection = context.document.getSelection();
                selection.load("text");

                await context.sync();

                const selectedText = selection.text;

                // Create a hidden span element to measure the text
                const span = document.createElement("span");
                span.style.position = "absolute";
                span.style.visibility = "hidden"; // Hide it
                span.style.font = window.getComputedStyle(document.body).font; // Match document font
                span.innerText = selectedText;
                document.body.appendChild(span);

                const rect = span.getBoundingClientRect(); // Get bounding box

                // Calculate X and Y coordinates
                const x = rect.left + window.scrollX;
                const y = rect.top + window.scrollY;

                // Clean up the dummy span
                document.body.removeChild(span);

                console.log(`Selected Text: "${selectedText}"`);
                console.log(`X: ${x}, Y: ${y}`);

                document.getElementById("output").innerText = `Selected Text: "${selectedText}", X: ${x}, Y: ${y}`;
            }).catch((error) => {
                console.error(error);
            });
        }
    </script>
</body>
</html>
